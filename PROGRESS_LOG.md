# Журнал разработки MusicPlayAndroidAI

## Отчет о состоянии проекта на 06.02.2026
*Данная запись является точкой отсчета и объединяет весь функционал, реализованный с начала разработки до текущего момента.*

---

### 1. Архитектура и Структура Проекта
*   **Язык разработки**: Kotlin с использованием современного декларативного подхода.
*   **UI Framework**: **Jetpack Compose** (полностью исключены XML-layout).
*   **Паттерн**: MVVM (Model-ViewModel-Repository), обеспечивающий четкое разделение бизнес-логики и интерфейса.
*   **Навигация**: Реализована через `Compose Navigation`. Внедрена централизованная система маршрутов (`AppDestination`) и кастомный `AppNavHost`.

### 2. Музыкальное Ядро (Media Engine)
*   **Плеер**: Использование современного стека **Media3 (ExoPlayer)**.
*   **Сервис воспроизведения**: Реализован `PlaybackService` (MediaSessionService), позволяющий музыке играть в фоновом режиме.
*   **MediaSession**: Полная интеграция с системой. Музыкой можно управлять через шторку уведомлений Android, экран блокировки и внешние устройства (наушники, Bluetooth-системы автомобилей).
*   **Управление Audio Focus**:
    *   Реализована автоматическая пауза при входящих/исходящих звонках.
    *   Предотвращение наложения звука: плеер останавливается, если другое приложение запускает аудио (YouTube, сторонние плееры).
    *   Поддержка "Becoming Noisy": автоматическая пауза при отключении наушников.
*   **Сканирование библиотеки**: Интегрирован `TracksRepository`, который сканирует медиа-хранилище устройства через `ContentResolver`, извлекает метаданные (название, артист, URI, обложки) и предоставляет их приложению.

### 3. Пользовательский Интерфейс (UI/UX)
*   **Стиль Glass Morphism**:
    *   Разработаны кастомные компоненты с эффектом матового стекла (Glass White/Black).
    *   Использование размытия и динамических полупрозрачных слоев.
*   **GlassDock (Навигационная панель)**:
    *   Уникальная плавающая панель навигации с эффектом размытия.
    *   **UX-улучшение**: Панель настроена так, что при каждом холодном старте приложения она открыта, обеспечивая быстрый доступ к разделам.
    *   Реализован невидимый слой (overlay) для закрытия панели по клику в любую область экрана.
*   **Список треков (Library Screen)**:
    *   **Интеллектуальный скроллинг**: Реализована логика, при которой выбранный трек автоматически центрируется относительно экрана устройства.
    *   **Визуальный стиль**: Выделение играющего трека реализовано через неоновую рамку (`Glow Color`) и иконку "Play", без изменения цвета текста, что сохраняет чистоту дизайна.
    *   **Оптимизация слоев**: Устранены графические артефакты (внутренние полосы) за счет правильного порядка наложения модификаторов (фон -> рамка -> clip).

### 4. Данные и Настройки
*   **Playback Persistence**: Приложение сохраняет ID текущего трека, позицию (в миллисекундах) и текущую очередь воспроизведения в `DataStore`. При перезапуске состояние восстанавливается мгновенно.
*   **Settings Management**: Создан `SettingsManager` для управления глобальными параметрами (например, настройки Audio Focus).
*   **Система разрешений**: Реализована динамическая проверка разрешений на чтение медиафайлов, адаптированная под разные версии Android (включая Android 13+).

### 5. Технологический Стек (Tools & Stack)
*   **Core**: Kotlin, Coroutines, Flow.
*   **UI**: Jetpack Compose, Material 3, Accompanist (для спецэффектов).
*   **Media**: Media3 (ExoPlayer + Session).
*   **Storage**: DataStore (Preferences), SharedPreferences.
*   **Architecture**: ViewModel, Repository.

---
*Статус: Приложение находится в активной фазе полировки UI и расширения функционала плеера.*

## 07.02.2026 — [В работе...]
*Начало новой сессии разработки. Ожидание задач.*
